"use strict";(globalThis.webpackChunkbook=globalThis.webpackChunkbook||[]).push([[589],{363(e,r,s){s.r(r),s.d(r,{assets:()=>c,contentTitle:()=>t,default:()=>p,frontMatter:()=>o,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"part-2-ros-2/chapter-4-ros-2-nodes-and-messages","title":"Chapter 4: Building a ROS 2 System","description":"Building a ROS 2 system involves creating workspaces, packages, and custom message types to facilitate communication between your robot\'s components. This chapter will walk you through the practical steps of setting up your development environment and creating your first ROS 2 nodes.","source":"@site/docs/part-2-ros-2/chapter-4-ros-2-nodes-and-messages.md","sourceDirName":"part-2-ros-2","slug":"/part-2-ros-2/chapter-4-ros-2-nodes-and-messages","permalink":"/Hackathon_Physical_AI_-Humanoid_Robotics_Book/docs/part-2-ros-2/chapter-4-ros-2-nodes-and-messages","draft":false,"unlisted":false,"editUrl":"https://github.com/your-org/humanoid-robotics-book/tree/main/docs/part-2-ros-2/chapter-4-ros-2-nodes-and-messages.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Chapter 3: ROS 2 Architecture","permalink":"/Hackathon_Physical_AI_-Humanoid_Robotics_Book/docs/part-2-ros-2/chapter-3-ros-2-architecture"},"next":{"title":"Chapter 5: Simulation-First Development","permalink":"/Hackathon_Physical_AI_-Humanoid_Robotics_Book/docs/part-3-simulation/chapter-5-simulation-first-development"}}');var i=s(4848),a=s(8453);const o={sidebar_position:4},t="Chapter 4: Building a ROS 2 System",c={},l=[{value:"Creating a ROS 2 Workspace",id:"creating-a-ros-2-workspace",level:2},{value:"Writing a Simple Publisher and Subscriber",id:"writing-a-simple-publisher-and-subscriber",level:2},{value:"Publisher Node",id:"publisher-node",level:3},{value:"Subscriber Node",id:"subscriber-node",level:3},{value:"Creating Custom Messages",id:"creating-custom-messages",level:2}];function d(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.header,{children:(0,i.jsx)(r.h1,{id:"chapter-4-building-a-ros-2-system",children:"Chapter 4: Building a ROS 2 System"})}),"\n",(0,i.jsx)(r.p,{children:"Building a ROS 2 system involves creating workspaces, packages, and custom message types to facilitate communication between your robot's components. This chapter will walk you through the practical steps of setting up your development environment and creating your first ROS 2 nodes."}),"\n",(0,i.jsx)(r.h2,{id:"creating-a-ros-2-workspace",children:"Creating a ROS 2 Workspace"}),"\n",(0,i.jsx)(r.p,{children:"A ROS 2 workspace is a directory where you store your ROS 2 packages. It's best practice to create a dedicated workspace for each project."}),"\n",(0,i.jsxs)(r.ol,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Create the workspace directory"}),":","\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"mkdir -p ~/ros2_ws/src\r\ncd ~/ros2_ws\n"})}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Initialize the workspace"}),":","\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"rosdep install --from-paths src --ignore-src -r -y\r\ncolcon build\n"})}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Source the workspace"}),":","\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"source install/setup.bash\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"writing-a-simple-publisher-and-subscriber",children:"Writing a Simple Publisher and Subscriber"}),"\n",(0,i.jsx)(r.h3,{id:"publisher-node",children:"Publisher Node"}),"\n",(0,i.jsx)(r.p,{children:"A publisher node sends data to a topic. Here's a basic Python example:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\nclass MinimalPublisher(Node):\r\n\r\n    def __init__(self):\r\n        super().__init__('minimal_publisher')\r\n        self.publisher_ = self.create_publisher(String, 'topic', 10)\r\n        timer_period = 0.5  # seconds\r\n        self.timer = self.create_timer(timer_period, self.timer_callback)\r\n        self.i = 0\r\n\r\n    def timer_callback(self):\r\n        msg = String()\r\n        msg.data = 'Hello ROS 2: %d' % self.i\r\n        self.publisher_.publish(msg)\r\n        self.get_logger().info('Publishing: \"%s\"' % msg.data)\r\n        self.i += 1\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    minimal_publisher = MinimalPublisher()\r\n    rclpy.spin(minimal_publisher)\r\n    minimal_publisher.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(r.h3,{id:"subscriber-node",children:"Subscriber Node"}),"\n",(0,i.jsx)(r.p,{children:"A subscriber node receives data from a topic:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\nclass MinimalSubscriber(Node):\r\n\r\n    def __init__(self):\r\n        super().__init__('minimal_subscriber')\r\n        self.subscription = self.create_subscription(\r\n            String,\r\n            'topic',\r\n            self.listener_callback,\r\n            10)\r\n        self.subscription  # prevent unused variable warning\r\n\r\n    def listener_callback(self, msg):\r\n        self.get_logger().info('I heard: \"%s\"' % msg.data)\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    minimal_subscriber = MinimalSubscriber()\r\n    rclpy.spin(minimal_subscriber)\r\n    minimal_subscriber.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(r.h2,{id:"creating-custom-messages",children:"Creating Custom Messages"}),"\n",(0,i.jsx)(r.p,{children:"For more complex data types, you can define custom messages."}),"\n",(0,i.jsxs)(r.ol,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsxs)(r.strong,{children:["Define ",(0,i.jsx)(r.code,{children:".msg"})," file"]}),":\r\nCreate ",(0,i.jsx)(r.code,{children:"msg/MyCustomMessage.msg"})," in your package:","\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"int32 id\r\nstring name\r\nfloat32 value\n"})}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsxs)(r.strong,{children:["Update ",(0,i.jsx)(r.code,{children:"package.xml"})]}),":\r\nAdd dependencies:","\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-xml",children:"<build_depend>rosidl_default_generators</build_depend>\r\n<exec_depend>rosidl_default_runtime</exec_depend>\r\n<member_of_group>rosidl_interface_packages</member_of_group>\n"})}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsxs)(r.strong,{children:["Update ",(0,i.jsx)(r.code,{children:"CMakeLists.txt"})]}),":\r\nAdd:","\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-cmake",children:'find_package(rosidl_default_generators REQUIRED)\r\nrosidl_generate_interfaces(${PROJECT_NAME}\r\n  "msg/MyCustomMessage.msg"\r\n)\n'})}),"\n","Then, you can ",(0,i.jsx)(r.code,{children:"colcon build"})," and use ",(0,i.jsx)(r.code,{children:"from your_package.msg import MyCustomMessage"}),"."]}),"\n"]})]})}function p(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,r,s){s.d(r,{R:()=>o,x:()=>t});var n=s(6540);const i={},a=n.createContext(i);function o(e){const r=n.useContext(a);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function t(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),n.createElement(a.Provider,{value:r},e.children)}}}]);